ch01.컨테이너 가상화 이해
Created at : 2025-02-17 22:14

# Summary
- 컨테이너 기술
	- 애플리케이션의 모든 요소를 (소스코드, 구성요소, 종송성 등) 하나의 런타임 환경으로 <span style="background:#d3f8b6">패키징한 논리적 공간</span>
	- 즉, 가상화한 <span style="background:#d3f8b6">경량의 격리된 프로세스</span>
		- 컨테이너의 운영체제이는 커널이 없다 (커널 공유)
		- 독립성을 갖기 때문에 다른 컨테이너에 영향을 주지 않는 <span style="background:#d3f8b6">stateless</span>(휘발성) 환경 제공
- 컨테이너 특징
	-  <span style="background:#d3f8b6">최소한의 Image를</span> 통해 실행되므로 경량
	- 어떤 환경에서도 동작 가능한<span style="background:#fff88f"> 이식성을</span> 보유하고 있다.
- 컨테이너 타입
	- 시스템(or OS) 컨테이너
	-  <span style="background:#fff88f">애플리케이션 컨테이너</span> 
	-  라우터 컨테이너
# Content
## Clip1 컨테이너 기술이란?

- 컨테이너 기술은 무엇인가요?
	- 컨테이너는 애플리케이션을 언제든 실행 가능하도록 필요한 모든 요소를 (소스코드, 구성요소, 종송성 등) 하나의 런타임 환경으로 <span style="background:#d3f8b6">패키징한 논리적 공간</span>을 말한다.
		- 이러한 패키징 기술을 docker에서는 Dockerfile build를 통해 구현
	- 한마디로, 애플리케이션과 종속 항목을 하나로 묶어, 실행하게 해주는 운영 시스템을 가상화한 <span style="background:#d3f8b6">경량의 격리된 프로세스</span>라고 볼 수 있다.
		- microVM 이라고도 함
		- 운영체제 수준의 가상화 제공
			- <font color="#2DC26B">컨테이너의 운영체제에는 커널이 없다.</font>
			- <font color="#2DC26B">그래서 Docker는 OS위에 올라가는 플랫폼이다.</font>
		- 독립성을 갖기 때문에 다른 컨테이너에 영향을 주지 않는 <span style="background:#d3f8b6">stateless</span>(휘발성) 환경 제공

	- 이 기술은 개인 데스크탑 뿐만 아니라 기업 내의 온프레미스 서버에서 AWS와 같은 퍼블릭 클라우드까지 언제 어디서든 빠르고 효율적으로 배포 가능하며, 확장성 또한 가지고 있다.
	- 이를 통해 서버구성, OS 설치, 네트워크, 개발 도구 구성 등의 반복적이고 불편한 작업에 시간을 낭비하지 않고 개발자는 애플리케이션 개발 그 자체에 집중할 수 있게 된다.
- 컨테이너 특징은 무엇인가요?
	- 컨테이너는 우리가 개발한 <span style="background:#d3f8b6">최소한의 Image를</span> 통해 실행되므로 경량이다.
		- 컨테이너 이미지 생성의 Best practice 중 하나는 <span style="background:#d3f8b6">이미지 경량화</span>다.
	- 일반 서버 환경에서의 애플리케이션 실행과 달리 언제든 프로세스 수준의 속도로 빠르게 실행 (run) 할 수 있고, 한번에 여러 개의 컨테이너를 동시에 실행 가능하다.
		- Docker 에서는 <span style="background:#d3f8b6">docker compose 기술</span>을 통해 구현한다.
	- 개인 환경이던 클라우드 환경이던 어떤 OS, 어떤 환경에서도 동작 가능한<span style="background:#fff88f"> 이식성을</span> 보유하고 있다.
	- 컨테이너 자체 애플리케이션 환경에 대한 관리만 요구되므로, 지속적 서버관리 비용을 **절감**할 수 있다.
	- 개발팀과 운영팀의 업무 분리로 각자의 업무와 세분화된 관리에 집중할 수 있다. 즉, 컨테이너는 DevOps workflow 구성에 최적이다.

- 컨테이너는 어떤 타입으로 생성되나요?
	- 컨테이너 <span style="background:#fff88f">패키징</span> 메커니즘 : <span style="background:#fff88f">시스템 / 애플리케이션</span> / 라우터 컨테이너
	- 시스템(or OS) 컨테이너
		- 호스트 OS 위에 Ubuntu와 같은 배포판 리눅스 Image를 통해 배포되는 컨테이너다.
		- 또 다른 VM의 형태이고, 내부에 다양한 애플리케이션 및 라이브러리 도구를 설치, 실행 가능하다.
		- 대표적으로 LXC(리눅스컨테이너), LXD, OpenVZ, Linux VServer, BSD Jails 등이 있다.
		![[Pasted image 20250217224125.png]]
	- <span style="background:#fff88f">애플리케이션 컨테이너</span> 
		- 단일 애플리케이션 실행을 위해 해당 서비스를 패키징하고 실행하도록 설계된 컨테이너다.
		- 3-tier 애플리케이션과 같은 경우 각 tier (frontend-backend-DB)를 개별 컨테이너로 샐행하여 연결.
		- 대표적으로 Docker container <span style="background:#fff88f">runtime</span>, Rocket 등이 있다.
		- ![[Pasted image 20250217224406.png]]
		- +) 시스템의 PID=1은 Systemd이다.
		- +) 시스템 컨테이너의 PID=1도 Systemd가 가진다. (OS가 PID=1을 가짐)
		- +) 애플리케이션 컨테이너의 PID=1은 해당 애플리케이션이 가진다.
	- Docker는 컨테이너를 실행하고 관리하는 container runtme 도구이다.
- Docker는 무엇인가요?
	- 여러 계층의 Application을 container로 분리, 연결하여 실행하는 MSA(MicroServiceArchitecture) 프로젝트에 유용하다.
		- => container끼리는 서로 API로 연결
	- Application의 Infra(runtime)는 Image를 통해 제공하고 Public or Private하게 공유 가능
		- => 환경을 만드는 것 => Image
	- Github와 유사한 방식(open share)으로 Docker Hub에서 제공 함. (https://hub.docker.com)
		- => Git과 Docker는 연동이 된다. Automatic Build (유료)
	- 이렇게 제공된 Image를 기반으로 Application 서비스를 제공, 이를 컨테이너화 (Containerization) 할 수 있다.
		![[Pasted image 20250217225847.png]]


# Clip2 docker 컨테이너 가상화와 VM 가상화 비교
- 컨테이너 trend history
	- ![[Pasted image 20250218221942.png]]
		- <font color="#2DC26B">LXC : linux Container, Kernel에 포함되어 있는 시스템 기능</font>
			- <font color="#2DC26B">chroot (pid =1을 만드는 기본 명령어, 독립된 환경)</font>
				- <font color="#2DC26B">fuse : chroot에 특정 경로를 mount 시켜서 daemon에 올리는 기술 </font>
			- <font color="#2DC26B">cgroup : CpuMemoryDiskNetork 할당할 수 있는 제어 능력</font>
			- <font color="#2DC26B">namespace : 디스크 마운트, 프로세스 정의, 네트워크 설정</font>
- 가상화(virtualization)?
	- 일반적으로 <span style="background:#d3f8b6">서버, 스토리지, 네트워크,애플리케이션 </span>등을 가상화 하여 하드웨어 <span style="background:#d3f8b6">리소스</span>를 <span style="background:#d3f8b6">효율적</span>으로 사용하는데 그 목적이 있고 이를 통해 기업은 효율적인 자원 활용, 자동화된 IT 관리, <span style="background:#d3f8b6">빠른 재해 복구</span> 등의 장점을 갖을 수 있다.
	- <span style="background:#d3f8b6">물리적 하드웨어 유지 관리</span> 대신 <span style="background:#d3f8b6">소프트웨어적으로 추상화</span>된 가상화를 통해 <span style="background:#d3f8b6">제한된 부</span>분을 <span style="background:#d3f8b6">쉽게 관리하고 유지</span>할 수 있다.
	- 하이퍼바이저 기반의 가상머신(VM, Virtual Machine)을 통해 수행한다.
		- Vmware, VirtualBox
- 컨테이너 가상화 vs. VM 가상화
	- 두 가지 가상화 모두 실행하고자 하는 애플리케이션 프로세스 및 종속 요소와 소스 등을.패키지, 즉 <span style="background:#fff88f">이미지화</span> 하여 HostOS와 격리된 환경을 제공한다!
		- <font color="#2DC26B">VM 이미지 기술 : OVF</font>
		- <font color="#2DC26B">Container 이미지 기술 : OCI</font>
	- 다만, VM 가상화는<span style="background:#d3f8b6"> 실제 호스트 운영체제</span>와 같이 별도의 <span style="background:#d3f8b6">Guest OS</span>를 두고 원하는 애플리케이션을 설치하는 <span style="background:#fff88f">하드웨어 수준의 가상화</span>를 구현하고,
		- <font color="#2DC26B">Guest OS에는 kernel이 있다. (자원을 할당 받아서 kernel을 따로 돌리기에 무겁다)</font>
		- <font color="#00b050">Booting을 한다.</font>
	- 컨테이너 가상화는 VM 가상화에 비해<span style="background:#d3f8b6"> 경량</span>이면서 호스트 운영체제의 <span style="background:#d3f8b6">커널을 공유</span>하는<span style="background:#fff88f"> 운영체제(OS) 수준의 가상화</span>를 구현한다.
	- 따라서, 컨테이너 가상화는 원하는 애플리케이션 환경을 빠르게 <span style="background:#d3f8b6">번들링하여 패키징</span>한다.
- 애플리케이션 배포 방식 비교
	- ![[Pasted image 20250218222222.png]]
- 컨테이너화 (containerization)기술
	- 리눅스컨테이너 기술은<span style="background:#d3f8b6"> LXC(Linux container)를 이용한 시스템 컨테이너화로 시작</span>
		- OS수준의 가상화 도구
		- cgroup. namespace 등의 <span style="background:#d3f8b6">커널 기술을 공유</span>하여 컨테이너에 제공
	- 이후 애플리케이션 컨테이너 기반의 Docker 출시가 되었고, 초기 Docker 버전은<span style="background:#d3f8b6"> LxC</span>를 활용해 컨테이너를 생성
	- 지속된 컨테이너 엔진의 발전으로 Docker는<span style="background:#d3f8b6"> containerd,runc</span>를 이용하는 방식으로 변경
		- 커널 기술의 공유를 통해 컨테이너 생성을 지원하는 <span style="background:#d3f8b6">runc</span>
		- 생성된 컨테이너의 라이프사이클 <span style="background:#d3f8b6">관리</span>를 지원하는 <span style="background:#d3f8b6">containerd</span>
		- 사용자 환경에서의 명령을 전달하는 <span style="background:#d3f8b6">dockerd</span>
	- ![[Pasted image 20250218222415.png]]
	- Docker 기능
		- ![[Pasted image 20250218222433.png]]

# Clip3 PWD(Play with Docker)
- Docker 컨테이너 놀이터 (Play with Docker)
	- https://www.docker.com/play-with-docker/