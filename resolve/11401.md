 # 이항 계수 3
Created at : 2025-12-19 18:21
[baekjoon_11401](https://www.acmicpc.net/problem/11401)
### 조건
- 시간 : 1
- 메모리 : 256
### 문제
자연수 \(N\)과 정수 \(K\)가 주어졌을 때 이항 계수 nCk를 1,000,000,007로 나눈 나머지를 구하는 프로그램을 작성하시오.
### 입력
첫째 줄에 \(N\)과 \(K\)가 주어진다. (1 ≤ \(N\) ≤ 4,000,000, 0 ≤ \(K\) ≤ \(N\))
### 출력
nCk를 1,000,000,007로 나눈 나머지를 출력한다.
### 제한
- 
### 예제
- 입력
```
5 2
```
- 출력
```
10
``` 

### 풀이
- My solution
```python
import sys
sys.setrecursionlimit(4000000)
  

def bino_coef(n, k):
    if k == 0 or n == k:
        return 1
    return (bino_coef(n-1, k) + bino_coef(n-1, k-1))%1000000007  

N,K = map(int,input().split())
print(bino_coef(N,K))
```

- Answer
```python
def power(a,n):
    result = 1
    while n:
        if n%2 == 1:
            result*=a
        a*=a
        a = a%p
        n = n//2
    return result

def factorial(n):
    result = 1
    for i in range(1,n+1):
        result *=i
        result = result%p
    return result

n,r = map(int,input().split())
p = 1000000007

print((factorial(n)*power(factorial(n-r)*factorial(r),p-2))%p)
```

- Analyze
	- 이항계수를 분리하여 계산하고 return 시켜 값을 구해주었다.
	- Answer
		- 아니 무슨 수학시간도 아니고.. 아무튼 너무 큰 수 (400만)이기에 위의 방법들은 메모리 초과 및 시간 초과가 나온다. (My solution 말고도 메모이제이션 기법을 활용하는등 여러 방법을 동원해 보았지만 실패하였다.)
		- 우선 조합 공식은 $_n​C_k​ = {N! \over (N-K)!K!}$ 이다.
		- 일단 [[모듈로 연산 분배법칙]]에 의해 나눗셈에서 나머지는 성립하지 않아서 [[곱셈의 역원]]을 구해야한다.
		- 여기서 중요한게 나눗셈 조건인 p(1000000007)가 소수라는 점이다. 여기서 [[페르마의 소정리]]를 응용해야한다. 
			- 페르마의 소정리 공식 : $a^p≡a(mod p)$
			- a가 p의 배수가 아니라면, $a^{p-1}≡1(mod p)$
			- 역원을 구하기 위한 식이니 다시 a를 나누어주면,  $a^{p-2}≡{1 \over a}(mod p)$
				- 위의 식이 성립하기 위해선 a가 p의 배수가 아니라는 점을 확인해야하는데 p는 소수이고, 구하려는 a는 $(N-K)!K!$이기에 이 팩토리얼 안에 p의 배수가 없으면 배수가 아니다. (p는 소수)
				- 조건이 최대 400만이기에 배수 일 수 없다.
			- 이제 식에 역원을 구하기 위해 분모인  $(N-K)!K!$를 대입하고 N!를 곱해주면, $N!((N-K)!K!)^{p-1}≡{N! \over (N-K)!K!} (modp)$
			- 즉, $N!((N-K)!K!)^{p-1}≡{_n​C_k​} (modp)$ 이 성립하게 된다.
		- 여기까지 진행 했으면, factorial함수와 거듭제곱 함수를 만들어서 %p로 나눗셈을 구하게 되면 답이 나온다.
		- 이건 그냥 거의 수학문제였다..
### 알고리즘 분류
- 